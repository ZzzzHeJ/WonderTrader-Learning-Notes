---
sort: 3
---

# 配置文件

在WT中，大量的设置通过配置文件的形式实现，配置文件可以分为以下几类：

1. 基本配置文件，所有策略、工具共用的基础配置
2. 策略配置文件，策略运行相关的配置文件，其中指定基本配置文件和数据所在目录，回测的相关设置，策略参数，行情服务器等等。
3. 普通配置文件，包括工具相关的配置文件，日志输出格式文件等。

## 基础配置文件

基础配置文件可以在项目中的demo目录下获取[common](https://github.com/wondertrader/wtpy/tree/master/demos/common)

### commodities.json

品种信息表，记录不同交易所中不同品种的相关信息，基本格式如下：(由于json无法使用注释，因此这里采用python的格式写，如果要使用请把注释删除)

```python
{
    "CFFEX": {                      # 交易所
        "IC": {                     # 品种名
            "covermode": 0,         # 平仓类型 表示该品种支持的开平模式
                                    # 0=开平 1=开平昨平今 
                                    # 2=平未了结的  3=不区分开平
            "pricemode": 0,         # 价格模式 0=市价限价 1=仅限价 2=仅市价
            "category": 1,          # 分类，参考CTP
                                    # 0=股票 1=期货 2=期货期权 3=组合 4=即期
                                    # 5=期转现 6=现货期权(股指期权) 7=个股期权(ETF期权)
                                    # 20=数币现货 21=数币永续 22=数币期货 23=数币杠杆 24=数币期权
            "trademode": 0,         # 交易模式，0=多空都支持 1=只支持做多 2=只支持做多且T+1
            "precision": 1,         # 价格小数点位数
            "pricetick": 0.2,       # 最小价格变动单位
            "volscale": 200,        # 合约倍数
            "name": "中证",         # 名称
            "exchg": "CFFEX",       # 所属交易所
            "session": "SD0930",    # 交易时间，具体参考session配置文件
            "holiday": "CHINA"      # 节假日，具体参考holiday.json
        },
        "IF": {
            "covermode": 0,
            "pricemode": 0,
            "category": 1,
            "trademode": 0,
            "precision": 1,
            "pricetick": 0.2,
            "volscale": 300,
            "name": "沪深",
            "exchg": "CFFEX",
            "session": "SD0930",
            "holiday": "CHINA"
        },
    }
    "CZCE": {
        "AP": {
            "covermode": 0,
            "pricemode": 0,
            "category": 1,
            "trademode": 0,
            "precision": 0,
            "pricetick": 1.0,
            "volscale": 10,
            "name": "苹果",
            "exchg": "CZCE",
            "session": "FD0900",
            "holiday": "CHINA"
        },
    }
}
```

### stk_comms.json

```python
{
    "SSE" : 
    {
        "STK" : 
        {
            "category" : 0,
            "covermode" : 0,
            "exchg" : "SSE",
            "holiday" : "CHINA",
            "name" : "上证股票",
            "precision" : 2,
            "pricemode" : 1,
            "pricetick" : 0.01,
            "session" : "SD0930",
            "volscale" : 1,
            "trademode": 2
        },
        "IDX" : 
        {
            "category" : 0,
            "covermode" : 0,
            "exchg" : "SSE",
            "holiday" : "CHINA",
            "name" : "上证指数",
            "precision" : 2,
            "pricemode" : 1,
            "pricetick" : 0.01,
            "session" : "SD0930",
            "volscale" : 1
        }
    },
}
```

### sopt_comms.json

股票期权信息

```python
{
    "SSE": {
        "ETFO": {
            "covermode": 0,
            "pricemode": 0,
            "category": 7,
            "precision": 4,
            "pricetick": 0.0001,
            "volscale": 10000,
            "name": "上证ETF期权",
            "exchg": "SSE",
            "session": "SD0930",
            "holiday": "CHINA"
        }
    },
    "SZSE": {
        "ETFO": {
            "covermode": 0,
            "pricemode": 0,
            "category": 7,
            "precision": 4,
            "pricetick": 0.0001,
            "volscale": 10000,
            "name": "深证ETF期权",
            "exchg": "SZSE",
            "session": "SD0930",
            "holiday": "CHINA"
        }
    }
}
```

### contracts.json

合约信息表，记录具体合约的相关信息，基本格式如下：

```python
{
    "CFFEX": {
        "IC2108": {
            "name": "中证2108",     # 名称
            "code": "IC2108",       # 代码
            "exchg": "CFFEX",       # 交易所
            "product": "IC",        # 品种
            "maxlimitqty": 20,      # 限价单单笔最大委托数量
            "maxmarketqty": 10      # 市价单单笔最大委托数量
        },
        "IC2109": {
            "name": "中证2109",
            "code": "IC2109",
            "exchg": "CFFEX",
            "product": "IC",
            "maxlimitqty": 20,
            "maxmarketqty": 10
        },
    }
}
```

```tip
对于commodities.json 与 contracts.json文件，wt提供了ctp_loader工具帮助维护，其前往工具集目录下查看如何使用。stk_comms.json 与 sopt_comms.json需要自行配置。
```

### fee.json

商品费率配置文件

```python
{
    "CFFEX.IF":                     # 交易所.品种代码
    {       
        "open":0.000023,            # 开仓费用法
        "close":0.000023,           # 平仓费用
        "closetoday":0.000345,      # 平今费用
        "byvolume":false            # 是否根据交易量决定，
                                    # 为true表示根据交易量也就是交易笔数决定费率
                                    # 为false表示根据交易额决定费率
    }
}
```

### fees_stk.json

股票费率配置文件

```python
{
    "SSE.STK":                      #上交所
    {
        "open":0.001,               # 开仓费用
        "close":0.0012,             # 平仓费用
        "closetoday":0.0,           # 平今费用
        "byvolume":false            # 是否根据交易量决定，
                                    # 为true表示根据交易量也就是交易笔数决定费率
                                    # 为false表示根据交易额决定费率
    },
    "SZSE.STK":                     # 深圳交所
    {
        "open":0.001,
        "close":0.0012,
        "closetoday":0.0,
        "byvolume":false
    }
}
```

### holidays.json

假期列表

```python
{
    "CHINA": [                      # 地区
        "20080101",                 # 日期，格式为yyyymmdd
        "20080206",
        "20080207",
        "20080208",
        "20080211",
    ]
}
```

### hots.json

主力换月信息

```python
{
 "DCE": {                           # 交易所
    "a": [                          # 品种，后面是每次主力换月信息的列表
            {
                "date": "20100423", # 换月时间
                "from": "a1009",    # 从何主力换月
                "newclose": 3992.0, # 换月后的主力合约的价格
                "oldclse": 3909.0,  # 换月前的主力合约价格
                "to": "a1101"       # 换到何主力
            },
            {
                "date": "20100722",
                "from": "a1101",
                "newclose": 3941.0,
                "oldclse": 3876.0,
                "to": "a1105"
            }
    ]
    }
}
```

### seconds.json

次主力换月信息,格式同hots.json

```tip
可以使用hotpicker
```

### session.json

交易时间的相关配置

```python
{
    "FN2300":{                      # 交易时段ID
        "name":"期货夜盘2300",       # 交易时段名称 
        "offset": 300,              # 交易时段偏移，对于含有夜盘的交易时段，需要将夜盘偏移到第二天，使
                                    # 得所有交易段位于同一日，300表示偏移3个小时，21点则会偏移到0点，
                                    # 不会影响策略开发，仅底层使用
        "auction":{                 # 集合竞价时段
            "from": 2059,           # 时段开始时间
            "to": 2100              # 时段结束时间
        },
        "sections":[                # 交易时段
            {
                "from": 2100,
                "to": 2300
            },
            {
                "from": 900,
                "to": 1015
            },
            {
                "from": 1030,
                "to": 1130
            },
            {
                "from": 1330,
                "to": 1500
            }
        ]
    },
    "FD0915":{
        "name":"期货白盘0915",
        "offset": 0,
        "auction":{
            "from": 929,
            "to": 930
        },
        "sections":[
            {
                "from": 930,
                "to": 1130
            },
            {
                "from": 1300,
                "to": 1515
            }
        ]
    }
}
```

### stk_sessions.json

股票交易时间

```python
{
    "SD0930":{
        "name":"股票白盘0930",
        "offset": 0,
        "auction":{
            "from": 929,
            "to": 930
        },
        "sections":[
            {
                "from": 930,
                "to": 1130
            },
            {
                "from": 1300,
                "to": 1500
            }
        ]
    }
}
```

### stk_options.json

股票期权信息

```python
{
    "SSE": {                            # 交易所
        "10003373": {                   # 代码
            "name": "50ETF购12月3061A", # 名称
            "code": "10003373",         # 代码
            "exchg": "SSE",             # 交易所
            "product": "ETFO",          # 品种类型
            "maxlimitqty": 50,          # 限价单单笔最大委托数量
            "maxmarketqty": 10,         # 市价单单笔最大委托数量
            "option": {
                "optiontype": 49,       # 期权类型类型 49=看涨期权，50=看跌期权
                "underlying": "510050", # 底层品种代码
                "strikeprice": 3.061,   # 行权价格
                "underlyingscale": 1.0  # 底层倍数
            }
        }
    }
}
```

### stocks.json

股票相关信息

```python
{
    "SSE": {                            # 交易所
        "000001": {                     # 代码
            "code": "000001",           # 代码
            "exchg": "SSE",             # 交易所
            "name": "上证综指",          # 名称
            "product": "IDX"            # 类型
        },
        "603383": {
            "area": "福建",             # 地区
            "code": "603383",           # 代码
            "exchg": "SSE",             # 交易所
            "indust": "软件服务",        # 所属行业
            "name": "顶点软件",          # 名称
            "product": "STK"             
        }
    }
}
```

## 策略配置文件

使用不同引擎的策略需要的策略配置文件不同，回测与仿真/实盘也有所区别，可以在对应的demo中，获取对应的配置文件信息

- CTA引擎
  - [回测](https://github.com/wondertrader/wtpy/tree/master/demos/cta_fut_bt)
  - [实盘](https://github.com/wondertrader/wtpy/tree/master/demos/cta_fut_bt)
- HFT引擎
  - [回测](https://github.com/wondertrader/wtpy/tree/master/demos/hft_fut_bt)
  - [实盘](https://github.com/wondertrader/wtpy/tree/master/demos/hft_fut)

策略配置文件可以采用yaml格式或者json格式，由于json格式无法添加注释，因此现在已经逐渐替换为yaml格式了

### configbt.yaml

策略回测的相关配置，包括以下部分

```yaml
replayer:                           # 数据回放设置
    basefiles:                      # 各个基础配置文件所在目录
        commodity: ../common/commodities.json
        contract: ../common/contracts.json
        holiday: ../common/holidays.json
        hot: ../common/hots.json
        second: ../common/seconds.json
        session: ../common/sessions.json
    fees: ../common/fees.json
    stime: 202101040900             # 回测开始时间
    etime: 202101061500             # 回测结束时间
    mode: csv                       # 数据回放模式，包括csv与bin
                                    # 不管是何种模式，首先回去his目录下查找
                                    # 如果his没有的话，csv模式会去csv模式下查找对应的csv文件，
                                    # 并转换为his目录下的dsb文件。
    path: ../storage/               # 数据存放路径
    tick: true                      # 是否开启tick回测，HFT回测时必须开启
env:
    mocker: cta                     # 回测引擎，cta/hft/sel/uft
    slippage: 1                     # 滑点，仅cta sel引擎的滑点有效

# CTA策略配置，当mocker为cta时会读取该配置项
cta:
    module: WtCtaStraFact.dll       # 模块名，linux下为xxxx.so
    strategy:                       # 策略信息
        id: dt_if                   # 策略ID，自定义的
        name: DualThrust            # 策略名，要和factory中的匹配
        params:                     # 策略初始化参数，这个根据策略的需要提供，不要被示例中所限制
            code: CFFEX.IF.HOT
            count: 50
            days: 30
            k1: 0.6
            k2: 0.6
            period: m5
            stock: false

# HFT策略配置，当mocker为hft时会读取该配置项
hft:
    module: WtHftStraFact.dll       # 模块名，linux下为xxxx.so
    use_newpx: true                # hft与uft中特有的选项，是否仅用最新价撮合，为false则会采用盘口撮合
    strategy:                       # 策略信息
        id: hft_if                  # 策略ID，自定义的
        name: SimpleHft             # 策略名，要和factory中的匹配
        params:                     # 策略初始化参数，这个根据策略的需要提供
            code: CFFEX.IF.HOT
            second: 5
            freq: 10
            offset: 0
            stock: false

# UFT策略配置，当mocker为uft时会读取该配置项
uft:
    module: WtUftStraFact.dll       # 模块名，linux下为xxxx.so
    use_newpx: true                # hft与uft中特有的选项，是否仅用最新价撮合，为false则会采用盘口撮合
    strategy:                       # 策略信息
        id: uft_if                  # 策略ID，自定义的
        name: SimpleUft             # 策略名，要和factory中的匹配
        params:                     # 策略初始化参数，这个根据策略的需要提供
            code: CFFEX.IF.HOT
            second: 5
            freq: 10
            offset: 0
            lots: 1
```

### config.yaml

实盘相关的配置

```yaml
replayer:                           # 数据回放设置
    basefiles:                      # 各个基础配置文件所在目录
        commodity: ../common/commodities.json
        contract: ../common/contracts.json
        holiday: ../common/holidays.json
        hot: ../common/hots.json
        second: ../common/seconds.json
        session: ../common/sessions.json
    bspolicy: actpolicy.yaml        # 执行配置文件名
    data:                       
        store: 
            path: ../storage/       # 历史数据存放目录
env:
    fees: \\WIN-52AMQLH0TIA\WonderTrader\common\fees.json
    filters: filters.json
    mode: product                   # 模式
    name: hft
    product:
        session: TRADING            # 交易时段，TRADING能够覆盖国内主要的交易时段
    mocker: cta                     # 回测引擎，cta/hft/sel/uft
    slippage: 1                     # 滑点，仅cta sel引擎的滑点有效

# CTA策略配置，当mocker为cta时会读取该配置项
cta:
    module: WtCtaStraFact.dll       # 模块名，linux下为xxxx.so
    strategy:                       # 策略信息
        id: dt_if                   # 策略ID，自定义的
        name: DualThrust            # 策略名，要和factory中的匹配
        params:                     # 策略初始化参数，这个根据策略的需要提供，不要被示例中所限制
            code: CFFEX.IF.HOT
            count: 50
            days: 30
            k1: 0.6
            k2: 0.6
            period: m5
            stock: false

# HFT策略配置，当mocker为hft时会读取该配置项
hft:
    module: WtHftStraFact.dll       # 模块名，linux下为xxxx.so
    use_newpx: true                # hft与uft中特有的选项，是否仅用最新价撮合，为false则会采用盘口撮合
    strategy:                       # 策略信息
        id: hft_if                  # 策略ID，自定义的
        name: SimpleHft             # 策略名，要和factory中的匹配
        params:                     # 策略初始化参数，这个根据策略的需要提供
            code: CFFEX.IF.HOT
            second: 5
            freq: 10
            offset: 0
            stock: false

# UFT策略配置，当mocker为uft时会读取该配置项
uft:
    module: WtUftStraFact.dll       # 模块名，linux下为xxxx.so
    use_newpx: true                # hft与uft中特有的选项，是否仅用最新价撮合，为false则会采用盘口撮合
    strategy:                       # 策略信息
        id: uft_if                  # 策略ID，自定义的
        name: SimpleUft             # 策略名，要和factory中的匹配
        params:                     # 策略初始化参数，这个根据策略的需要提供
            code: CFFEX.IF.HOT
            second: 5
            freq: 10
            offset: 0
            lots: 1
```

### actpolicy.yaml

### executers.yaml

### filters.yaml

### logcfg.yaml

### tdparsers.yaml

### tdtraders.yaml

